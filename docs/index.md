---
page_title: "filess Provider"
description: |-
  The filess provider allows you to manage dedicated databases on filess.io platform.
---

# filess Provider

The filess provider enables you to create, manage, and configure dedicated databases on the [filess.io](https://filess.io) platform using Infrastructure as Code.

## Features

- ğŸ—„ï¸ **Database Management**: Create and manage dedicated databases with custom configurations
- ğŸŒ **Multi-Region**: Deploy databases across multiple regions
- ğŸ”§ **Multiple Engines**: Support for MySQL, PostgreSQL, MariaDB, MongoDB, and more
- ğŸ’³ **Automatic Billing**: Integrated Stripe checkout for seamless payment processing
- ğŸ” **Credential Management**: Automatic retrieval of connection credentials
- âœ… **State Reconciliation**: Handles external changes and deleted resources gracefully

## Example Usage

```terraform
terraform {
  required_providers {
    filess = {
      source = "filess-io/dedicated"
      version = ">=1.0.6"
    }
  }
}

provider "filess" {
  api_token = var.filess_api_token
  api_url   = var.filess_api_url
}

variable "filess_api_token" {
  type        = string
  description = "API token for filess.io"
  sensitive   = true
}

variable "filess_api_url" {
  type        = string
  description = "Base URL for filess.io API"
  default     = "https://backend.filess.io"
}

variable "organization_slug" {
  type        = string
  description = "Organization slug"
}

variable "namespace_slug" {
  type        = string
  description = "Namespace slug"
}

# Data sources para obtener engines y regions
data "filess_engines" "all" {}
data "filess_regions" "all" {}

# Encontrar MySQL 8.0 engine
locals {
  mysql_engine = [
    for engine in data.filess_engines.all.engines : engine
    if engine.name == "MySQL" && engine.version == "8.0"
  ][0]
  
  # Usar la primera regiÃ³n disponible
  selected_region = data.filess_regions.all.regions[0]
}

# Crear base de datos MySQL con todos los billable items requeridos
resource "filess_database" "mysql_test" {
  organization_slug = var.organization_slug
  namespace_slug    = var.namespace_slug
  
  name        = "terraform-mysql-db"
  description = "MySQL database created by Terraform provider"
  
  engine_id = local.mysql_engine.id
  region_id = local.selected_region.id
  
  database_plan {
    # Required billable items (segÃºn /api/v1/databases/create/metadata)
    billable_items {
      billable_item_id = "6"   # db_storage_500MiB - Storage 0.5GiB (mÃ­nimo 1, mÃ¡ximo 50)
      quantity         = 1
    }
    
    billable_items {
      billable_item_id = "7"   # network_bandwidth_1M - Network Bandwidth 1MB/s (mÃ­nimo 100, mÃ¡ximo 400)
      quantity         = 100
    }
    
    billable_items {
      billable_item_id = "8"   # choose_region - Choose Region (mÃ­nimo 1, mÃ¡ximo 1)
      quantity         = 1
    }
    
    billable_items {
      billable_item_id = "10"  # cpu_core_500m - CPU Core 0.25 (mÃ­nimo 1, mÃ¡ximo 16)
      quantity         = 1
    }
    
    billable_items {
      billable_item_id = "12"  # db_instance - Database Setup (mÃ­nimo 1, mÃ¡ximo 1)
      quantity         = 1
    }
    
    billable_items {
      billable_item_id = "13"  # memory_500MiB - Memory 0.5GiB (mÃ­nimo 1, mÃ¡ximo 8)
      quantity         = 1
    }
  }
}

output "database_id" {
  value = filess_database.mysql_test.id
}

output "database_name" {
  value = filess_database.mysql_test.name
}

output "database_status" {
  value = filess_database.mysql_test.status
}

output "database_engine" {
  value = local.mysql_engine.name
}

output "database_version" {
  value = local.mysql_engine.version
}

output "database_region" {
  value = local.selected_region.name
}

output "database_hostname" {
  value = filess_database.mysql_test.database_hostname
}

output "database_service_port" {
  value = filess_database.mysql_test.database_service_port
}

output "database_username" {
  value = filess_database.mysql_test.database_username
}

output "database_password" {
  value     = filess_database.mysql_test.database_password
  sensitive = true
}
```

## Authentication

The provider requires an API token for authentication. You can obtain your API token from the [filess.io dashboard](https://filess.io/dashboard).

### Using Environment Variables (Recommended)

```bash
export TF_VAR_filess_api_token="your-api-token-here"
```

### Using Variables File

Create a `terraform.tfvars` file (never commit this file):

```hcl
filess_api_token = "your-api-token-here"
filess_api_url   = "https://backend.filess.io"  # Optional, this is the default
```

## Provider Configuration

The provider can be configured with the following options:

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `api_token` (String) API token for filess.io authentication

### Optional

- `api_url` (String) Base URL for filess.io API

## Important Notes

### Credential Retrieval

When creating a database, the provider automatically waits for the database to be fully provisioned and retrieves connection credentials. These include:

- `database_hostname`: The hostname to connect to
- `database_service_port`: The port number
- `database_username`: The username (typically "root")
- `database_password`: The password (marked as sensitive)

### Payment Required

If your organization doesn't have a default payment method configured, the provider will display a Stripe checkout URL during the apply process. You must complete the payment for provisioning to continue.

The URL will be displayed directly in your terminal:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  âš ï¸  PAYMENT REQUIRED                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

The database requires payment to continue provisioning.
Please open this URL to complete the Stripe checkout:

  https://checkout.stripe.com/...

Waiting for payment completion...
```

### State Management

For production use, we recommend using remote state storage:

```hcl
terraform {
  backend "s3" {
    bucket = "my-terraform-state"
    key    = "filess/terraform.tfstate"
    region = "us-east-1"
  }
}
```

## Support

- ğŸ“§ Support: support@filess.io
- ğŸ“š Documentation: https://docs.filess.io
- ğŸ› Issues: https://github.com/filess/terraform-provider-dedicated/issues

